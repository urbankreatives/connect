function FindProduct(n){var t;if($.each(billPayProvider.Products,function(){var i=this;if(i.Code==n)return t=i,!1}),!t)throw new Error("Product not found");return t}function AddProduct(n){var i=$("#products-container .payment-details-container").length,t;if(i>0&&!billPayProvider.AllowMultipleProductsPerPayment)alert("Sorry,
"+billPayProvider.Name+" does not permit more than one product per payment.");else{if($("input[name^=product-code-][value="+n+"]").length!=0)return;t=FindProduct(n);$("#products-container .well").addClass("hidden");$("#products-container").prepend(CreateInputGroup(t));billPayProvider.AllowMultipleProductsPerPayment||$("#product-selector").hide()}$("#products-container").trigger("topupProductContainerDisplayed",{productCode:n,productIndex:productIndex-1,hasMultipleProducts:!0})}function
RemoveProduct(n){$("#product-container-"+n).remove();var t=$("#products-container .payment-details-container").length;t==0&&($("#product-selector").show(),$("#products-container .well").removeClass("hidden"));$("#products-container").trigger("topupProductContainerRemoved",{existingProducts:t})}function
CreateInputGroup(n){var r="",f=typeof Cookies=="undefined"?null:Cookies.get("amount-"+n.CssCookieIdentifier),e=typeof Cookies=="undefined"?null:Cookies.get("qty-"+n.CssCookieIdentifier),t,i,u;if(amount&&(f=amount),t=productIndex++,r="
<fieldset class='payment-details-container'
    id='product-container-"+t+"'>
    <legend>"+n.Name+"<button type='button' class='btn btn-xs btn-danger pull-right' onclick='RemoveProduct("+t+");'>Remove<\/button><\/legend><input type='hidden' name='product-code-"+t+"' value='"+n.Code+"' />",n.AllowSpecifyQuantity&&n.AuthAmountMandated!=!0&&(r+="<div class='form-group'><label for='quantity-"+t+"'>"+n.QuantityFieldLabel+"<\/label><input class='form-control' type='number' min='1' id='quantity-"+t+"' name='quantity-"+t+"' required value='"+e+"' />"+(n.QuantityFieldDesc?"<small class='subtext'>"+n.QuantityFieldDesc+"<\/small>":"")+"<\/div>"),n.AuthAmountMandated==null?(n.Price&&(f=n.Price),r+="<div class='form-group'><label for='amount-"+t+"'>"+n.AmountFieldLabel+"<\/label><div class='input-group'><div class='input-group-addon'>ZWL<\/div> <input class='form-control' type='number'"+MinMaxAmount(n)+" step='0.01' id='amount-"+t+"' name='amount-"+t+"' data-forex='"+n.RequiresForex+"' required value='"+f+"' "+(n.Price?"readonly":"")+" /><\/div>"+(n.AmountFieldDesc?"<small class='subtext'>"+n.AmountFieldDesc+"<\/small>":"")+"<\/div>"):r+='<div style="margin-bottom: 10px;">The payment amount will be confirmed in the next step<\/div>',n.MetadataFields)for(i=0;i<n.MetadataFields.length;i++)u=n.MetadataFields[i],r+="<div><input type='hidden' name='product-"+t+"-metadata-field-"+i+"' value='"+u.Name+"' /><label for='product-"+t+"-metadata-value-"+i+"'>"+u.Name+"<\/label><input type='text' "+(u.Required?" required='required'":"")+" name='product-"+t+"-metadata-value-"+i+"' id='product-"+t+"-metadata-value-"+i+"' class='form-control' />"+(u.Description?"<small>"+u.Description+"<\/small>":"")+"<\/div>";return n.ReminderDays&&(r+='<div class="form-group reminder-container"><div class="checkbox checkbox-primary"><input type="checkbox" name="reminder-'+t+'" id="reminder-'+t+'" class="form-control" value="true"'+(disableAutoremind?"":" checked='checked'")+'/><label for="reminder-'+t+'">Remind me again after '+n.ReminderDays+' days<\/label><\/div><input type="hidden" name="reminder-'+t+'" value="false"><\/div>'),r+"<div class='clear'><\/div><\/fieldset>"}function MinMaxAmount(n){var t="";return n.MinAmount&&(t+=" min='"+n.MinAmount+"'"),n.MaxAmount&&(t+=" max='"+n.MaxAmount+"'"),t}function Purchase(){if(alreadySubmitted)return!1;var e=$("#cmdProceed"),o=$(".cancel-button"),r=$("input[name=email]"),u=$("input[name=mobile]"),i=$("input[name=amount]"),t="",n=null,f=0;return($("#products-container input:hidden[name^=product-code-]").length==0&&(t+="You havent added any items to your payment. Click 'Add an Item' to add product(s) first.\n",n=$("#product-selector-button")),i.length>0&&(f=parseFloat(i.val())),i.length>0&&isNaN(f)&&(t+="You must enter an amount for this payment\n",n=i),r.val().length==0||/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(r.val())||(t+="You must enter a valid e-mail address where your payment details will be sent\n",n||(n=r)),u.val().length!=0&&/^(?![1-9])\+?\d{9,15}$/.test(u.val())||(t+="Enter a valid mobile number where your payment details will be sent\n",n||(n=u)),t.length>0)?(alert(t),n&&n.focus(),!1):(alreadySubmitted=!0,e.prop("disabled",!0).text("Please wait..."),o.hide(),!0)}var alreadySubmitted=!1;$(function(){var n=$("#product-selector");n.find(".entry").length>1&&n.removeClass("hidden");$(".dropdown-submenu > a").on("click",function(n){$(this).parent().siblings().removeClass("open");$(this).parent("li").toggleClass("open");n.stopPropagation();n.preventDefault()});$(".dropdown-submenu a").not($(".dropdown-submenu > a")).on("click",function(){$(this).parents("ul").parents("li").removeClass("open")});window.forex&&window.allowExchangeRateSales&&setInterval(function(){var n=0;$.each($("input[id^=amount-]").not("[data-forex=true]"),function(){var t=$(this),f=t.attr("id").substr(7),i=parseFloat(t.val()),r=$("#quantity-"+f),u=parseInt(r.length>0?r.val():1);n+=(isNaN(u)?0:u)*(isNaN(i)?0:i)});n==0?($("#forex-price").text("0.00"),$("#forex-conversion").hide()):($("#forex-price").text((Math.ceil(n*100/window.currencyRate)/100).toFixed(2)),$("#forex-conversion").show())},500)})